===============
Installing Spin
===============

This document covers Spin requirements, installation, and getting started.

Requirements
============

Spin has been tested on systems running Red Hat Enterprise Linux 5, CentOS 5,
and Fedora versions 7, 8 and 9.

The following packages are needed for Spin to run:

* ImageMagick
* createrepo
* netpbm-progs
* python
* python-devel
* python-imaging
* python-lxml
* python-setuptools
* rendition-common
* rpm-build
* syslinux
* yum

Note: Some of the packages (e.g. python-lxml) can be found in the Extra Packages
for Enterprise Linux (EPEL) or Fedora Everything RPM repositories.


Installation
============

Spin RPMs will be coming soon.  In the meantime, this document describes how you
can obtain Spin and run it directly from source code.


In the following instructions, we assume that the working directory is
``SPIN_RUN``.

1. Clone **Spin** source code repositories
------------------------------------------

::

  $$ cd $SPIN_RUN
  $$ hg clone https://www.renditionsoftware.com/hg/public/spin
  $$ hg clone https://www.renditionsoftware.com/hg/public/rendition-common


In your ``~/.bashrc`` file, add the following line

::

  export PYTHONPATH=$SPIN_RUN/rendition-common:$SPIN_RUN/spin:$PYTHONPATH


and then at the command line

::

  $$ source ~/.bashrc


2. Create the Spin configuration file
-------------------------------------

Create a file called ``/etc/spin.conf`` and add the following lines:

::

  <spin>
    <share-path>$SPIN_RUN/spin/share/spin</share-path>
  </spin>

Alternatively, you can copy ``$SPIN_RUN/spin/share/doc/examples/spin.conf`` 
to the /etc folder as a starting point and modify the share-path.

3. Install Spin dependencies
----------------------------

Install packages listed above under `Requirements`. Note that yum must be run
as the root user.

::

  $$ yum install (dependencies listed above)  


Getting Started
===============

1. Create a Distribution Definition File (.distro)
--------------------------------------------------

Spin includes some example files to help you get started. Copy these files to
a new folder, called ``DISTRO_DIR`` below.  While you are experimenting, you 
will most likely want DISTRO_DIR to be in your home folder. Later you will want
to maintain your .distro and related files using a Source Code Management 
system such as CVS, SVN, git, or the like.

::

  $$ mkdir $DISTRO_DIR
  $$ cd $SPIN_RUN/spin/share/doc/example/
  $$ cp minimal.distro example.distro $DISTRO_DIR
  $$ cd $DISTRO_DIR


Now you can open and modify the minimal.distro and example.distro files. 

Distribution definition files (distrofiles or .distro files) define your 
distribution, including name, version, packages to include, the base distribution
to use (e.g. CentOS 5, Fedora 9), etc. Minimal.distro is an abbreviated 
distrofile showing common options. Example.distro is a commented distrofile 
containing an overview of general concepts, and descriptions of many elements 
and their usage.

As an experiment, modify the minimial.distro file to create a distribution 
based on Fedora 9 x86_64 by modifying the main and base sections of the file to 
contain the following:

::

  <main>
    <fullname>Example</fullname>
    <product>example</product>
    <version>f9</version>
    <arch>x86_64</arch>
  </main>

  <base>
    <distro>fedora</distro>
    <version>9</version>
    <!--<baseurl-prefix>http://www.my.org/centos</baseurl-prefix>-->
    <!--<baseurl-prefix>http://www.my.org/pub/fedora/linux</baseurl-prefix>-->
  </base>

Spin will automatically locate and download files using public mirror locations. 
Change and uncomment the baseurl-prefix to point to a local mirror, if one is 
available, for improved performance.


2. Running Spin
---------------

To run Spin, type the following at the command line. Note that Spin must be run
as the root system user; this is required because Spin mounts and modifies
installation images.

::

        $SPIN_RUN/bin/spin $DISTRO_DIR/minimal.distro


3. Using the Custom Distribution
--------------------------------

Your new custom Linux distribution can be found at ``/var/www/html/distros``.  
Enjoy!


4. Questions/Comments/Issues
----------------------------

Send email to ``spin@renditionsoftware.com``.

