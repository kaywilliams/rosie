<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN"
                         "http://www.oasis-open.org/docbook/xml/4.1.2/docbookx.dtd">


<!-- See http://www.docbook.org/tdg/en/html/refentry.html for more documentation -->
<!--Deploy Command reference -->

<refentry id="command.deploy">
<refentryinfo>
<date>2012-12-17</date>
</refentryinfo>
 
<refmeta>
<refentrytitle>Deploy Commands</refentrytitle>
<manvolnum>1</manvolnum>
<refmiscinfo>Deploy</refmiscinfo>
</refmeta>

<refnamediv>
<refname>deploy</refname>
<refpurpose>creates RPM package repositories for use with CentOS and Red Hat Enterprise Linux.</refpurpose>
</refnamediv>

<refsynopsisdiv>
<refsynopsisdivinfo>
<date>2012-04-18</date>
</refsynopsisdivinfo>

<cmdsynopsis>
<command>deploy</command>
<arg choice="opt">
<option>[-c | --config ] <replaceable class="parameter">PATH</replaceable></option>
</arg>
<arg choice="opt">
<option>--macro <replaceable class="parameter">ID:VALUE</replaceable></option>
</arg>
<arg choice="opt">
<option>--offline </option>
</arg>
<arg choice="opt">
<option>--no-validate </option>
</arg>
<arg choice="opt">
<option>--validate-only </option>
</arg>
<arg choice="opt">
<option>[-l | --log-level ] <replaceable class="parameter">N</replaceable></option>
</arg>
<arg choice="opt">
<option>--log-file <replaceable class="parameter">PATH</replaceable></option>
</arg>
<arg choice="opt">
<option>--data-dir <replaceable class='parameter'>PATH</replaceable></option>
</arg>
<arg choice="opt">
<option>--lib-path <replaceable class="parameter">PATH</replaceable></option>
</arg>
<arg choice="opt">
<option>--share-path <replaceable class="parameter">PATH</replaceable></option>
</arg>
<arg choice="opt">
<option>--force <replaceable class="parameter">MODULE</replaceable></option>
</arg>
<arg choice="opt">
<option>--skip <replaceable class="parameter">MODULE</replaceable></option>
</arg>
<filename> DEFINITION</filename>

</cmdsynopsis>
</refsynopsisdiv>

<refsect1 id="deploy.1-description"><title>DESCRIPTION</title>
<para>Builds and maintains the repository defined in the file at
DEFINITION.</para>
</refsect1>

<refsect1 id="deploy.1-usage"><title>USAGE</title>
<para><command>deploy</command> [OPTIONS] DEFINITION</para> <para>OPTIONS
refers to the command-line options described below.  DEFINITION refers to a
definition file, see the Deploy Definition File Reference at
 <ulink url="http://www.deployproject.org/docs"/> for more information.</para>
</refsect1>


<refsect1 id="deploy.1-options"><title>OPTIONS</title>
<para>Command options are listed in alphabetical order.</para>
<variablelist>

<varlistentry>
  <term><option>-c; --config <replaceable class="parameter">DEPLOY_CONF</replaceable></option></term>
  <listitem>
    <para> Specifies the directory and filename <replaceable
    class="parameter">DEPLOY_CONF</replaceable> of the deploy
    configuration file.  The default value is <filename
    class="directory">/etc/deploy/deploy.conf</filename>.  See the
    <filename> deploy.conf(5)</filename> man page for Deploy
    configuration options.</para>

  </listitem>
</varlistentry>

<varlistentry>
  <term><option>--data-dir <replaceable class="parameter">PATH</replaceable></option></term>
  <listitem>
    <para>
    Specifies the directory <replaceable class="parameter">PATH</replaceable>
    where Deploy should write the definition data file. The default path is the
    definition directory.
    </para>
  </listitem>
</varlistentry>

<varlistentry>
  <term><option>--force <replaceable class="parameter">MODULE</replaceable></option></term>
  <listitem>
        <para>Forces a Deploy <replaceable
        class="parameter">MODULE</replaceable> to execute, even if the module
        would ordinarily be skipped for optimizations in speed. Forcing a
        module forces its children recursively. This option can be specified
        more than once, as in the example below:</para>

<para>--force <replaceable class="parameter">MODULE1</replaceable> --force
<replaceable class="parameter"> MODULE2</replaceable> --force <replaceable
class="parameter">MODULE3</replaceable></para>
<para>See the MODULES section below for more information.</para>
  </listitem>
</varlistentry>

<varlistentry>
  <term><option>--lib-path <replaceable class="parameter">PATH</replaceable></option></term>
  <listitem>
    <para>By default, Deploy searches directories listed on the system
    path to locate Deploy modules.  The --lib-path option allows
    specifing additional directory <replaceable
    class="parameter">PATHs</replaceable> to search.  This option can be
    specified more than once; for example:</para>
<para>--lib-path <replaceable class="parameter">PATH1</replaceable> --lib-path
<replaceable class="parameter"> PATH2</replaceable> --lib-path <replaceable
class="parameter">PATH3</replaceable></para>
<para>See the MODULES section below for more information.</para>
  </listitem>
</varlistentry>

<varlistentry>
  <term><option>--log-file <replaceable class="parameter">PATH</replaceable></option></term>
  <listitem>
    <para>
    Specifies the directory and filename <replaceable
    class="parameter">PATH</replaceable> to which Deploy writes logging
    information.  The default path is
    <filename>/var/log/deploy.log</filename>.  See also the command option
    <command>--log-level</command>.
    </para>
    <para>
    --log-file <replaceable class="parameter">PATH</replaceable>
    </para>
  </listitem>
</varlistentry>

<varlistentry>
  <term><option>-l; --log-level <replaceable class="parameter">N</replaceable></option></term>
  <listitem>
    <para>
    Specifies the level of detail displayed on the console during a
    build.  There are six levels <replaceable class="parameter">N</replaceable>
    (0 to 5) with Level 3 being Deploy's default level.
    </para>
<para>LEVELS
<programlisting>
* Level 0: Displays errors only.
* Level 1: Displays build status.
* Level 2: Displays module status. See MODULES.
* Level 3: Displays file download and creation status (default).
* Level 4: Displays script output; file copy and delete status. 
* Level 5: Displays complete debug-level status.
</programlisting>
</para>
<para>Setting the log level to 0 will prevent all logging except errors to the
screen, while levels 1 to 5 have increasingly more detail about the build
process.
</para>
<para>This setting controls the level of detail displayed on the console only,
and not the log file. Level 5 detail is always written to the log file.
</para>
</listitem>
</varlistentry>

<varlistentry>
  <term><option>--macro</option></term>
  <listitem>
    <para>Specifies a macro <replaceable class="parameter">ID</replaceable> and
    <replaceable class="parameter">VALUE</replaceable> to use for placeholder
    substitution in the DEFINITION. <replaceable
    class="parameter">ID</replaceable> and <replaceable
    class="parameter">VALUE</replaceable> are text values separated by a colon.
    Specifically, <replaceable class="parameter">VALUE</replaceable> may not
    contain XML. Placeholders in the DEFINITION take the form '%{<replaceable
    class="parameter">ID</replaceable>}'. This option may be specified more
    than once, for example: 
    </para>
    <para>--macro <replaceable class="parameter">ID1:VALUE1</replaceable>
    --macro <replaceable class="parameter">ID2:VALUE2</replaceable> --macro
    <replaceable class="parameter"> ID3:VALUE3</replaceable>
    </para>
  </listitem>
</varlistentry>

<varlistentry>
  <term><option>--no-validate</option></term>
  <listitem>
    <para>Disables validation of DEPLOY_CONF and DEFINITION during the build process.</para>
  </listitem>
</varlistentry>

<varlistentry>
  <term><option>--offline</option></term>
  <listitem>
    <para>Instructs Deploy to retrieve files from the cache rather than from
    remote locations.</para>
  </listitem>
</varlistentry>

<varlistentry>
  <term><option>--share-path <replaceable class="parameter">PATH</replaceable></option></term>
  <listitem>
    <para> Specifies a directory <replaceable
    class="parameter">PATH</replaceable> where Deploy can locate shared
    program data such as example files and XML schema files. The default path is
    <filename>/usr/share/deploy/</filename>. This option can be specified
    more than once, as demonstrated below:</para>

<para>--share-path <replaceable class="parameter">PATH1</replaceable>
--share-path <replaceable class="parameter">PATH2</replaceable> --share-path
<replaceable class="parameter"> PATH3</replaceable></para>
  </listitem>
</varlistentry>

<varlistentry>
  <term><option>--skip <replaceable class="parameter">MODULE</replaceable></option></term>
  <listitem>
        <para>Prevents a <replaceable class="parameter">MODULE</replaceable>
        from executing, even if the module would ordinarily be executed due to
        changes in input, output or other factors. Skipping a module skips its
        children recursively. This option can be specified more than once, as
        in the example below:</para>
<para>--skip <replaceable class="parameter">MODULE1</replaceable> --skip
<replaceable class="parameter"> MODULE2</replaceable> --skip <replaceable
class="parameter">MODULE3</replaceable></para>
<para>See the MODULES section below for more information.</para>
  </listitem>
</varlistentry>

<varlistentry>
  <term><option>--validate-only</option></term>
  <listitem>
<para>Performs DEPLOY_CONF and DEFINITION validation only; it
does not build the repository.  The option also displays the complete
DEFINITION file after resolving macro and include elements.</para>
  </listitem>
</varlistentry>

</variablelist>
</refsect1>

<refsect1 id="deploy.1-variables"><title>VARIABLES</title>
<para>Deploy command options, where indicated, use three variables:
MODULE, PATH and DEPLOY_CONF.</para>

<variablelist>
<varlistentry>
  <term>MODULE</term>
  <listitem>
        <para>The id of a Deploy module.  See the MODULES section,
        below, for more information.</para>
  </listitem>
</varlistentry>

<varlistentry>
  <term>PATH</term>
  <listitem>
    <para> A local file path.  Deploy resolves paths relative to the
    current working directory.</para>
  </listitem>
</varlistentry>

<varlistentry>
  <term>DEPLOY_CONF</term>
  <listitem>
    <para>The directory and filename of the Deploy configuration file.</para>
  </listitem>
</varlistentry>
</variablelist>
</refsect1>

<refsect1 id="deploy.1-modules"><title>MODULES</title>
<para>
A module performs an individual step in the build process, such as
downloading software packages, creating packages or creating ISO images. 
On subsequent builds of the same repository, Deploy automatically
determines whether a module can be skipped in favor of using cached data from a
previous build. Users can override the default determination using the
<command>--skip</command> and <command>--force</command> options.
</para>
<para>
Module names correspond to top-level elements in the DEFINITION.
</para>
<para>
Developers can write custom Deploy modules and direct Deploy to use them via the <command>--lib-path</command> deploy command
option.
</para>
</refsect1>

<refsect1 id="deploy.1-bugs"><title>BUGS</title>
<para>See the web site at <ulink
url="http://www.deployproject.org"/> for contact and support
information.</para>
</refsect1>

<refsect1 id="deploy.1-files"><title>FILES</title>
<para><simplelist type="inline">
<member><ulink url="file:///usr/share/deploy/">/usr/share/deploy/</ulink></member>
<member><ulink url="file:///usr/bin/deploy">/usr/bin/deploy</ulink></member>
<member><ulink url="file:///etc/deploy/deploy.conf">/etc/deploy/deploy.conf</ulink></member>
<member><ulink url="file:///var/log/deploy.log">/var/log/deploy.log</ulink></member>
<member><ulink url="file:///var/cache/deploy/">/var/cache/deploy/</ulink></member>
<member><ulink url="file:///var/lib/deploy/">/var/lib/deploy/</ulink></member>
</simplelist></para>
</refsect1>

<refsect1 id="deploy.1-see_also"><title>SEE ALSO</title>
<para><simplelist type="inline">
<member>deploy.conf(5)</member>
<member><ulink url="http://www.deployproject.org"/></member>

</simplelist></para>
</refsect1>

<refsect1 id="deploy.1-author"><title>AUTHOR</title>
<para><author><othername>Deploy Foundation</othername>
<contrib>Original author</contrib>
</author></para>
</refsect1>

</refentry>
