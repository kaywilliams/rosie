<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
"http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd">
<section id="configuring-a-build-machine" xreflabel="Configuring a Build Machine">
  <title>Configuring a Build Machine</title>

  <para><application class="software">SystemBuilder</application> is designed to work
  in a networked environment. You can install <application
  class="software">SystemBuilder</application> on a <application
  class="software">Linux</application> system operating with <application
  class="software">CentOS</application> 5 or <application class="software">Red
  Hat Enterprise Linux</application> 5.</para>

  <para>Recent advances in virtualization, including the introduction of a Kernel-based Virtual Machine solution (KVM), have made it both easy and compelling to use virtual machines for testing client installation and updates. For this reason, we recommend installing SystemBuilder on a system installed with the x86_64 version <application class="software">Red Hat Enterprise Linux</application> 5.4 or <application
  class="software">CentOS</application> 5.4, using one of the following architectures:</para>

  <itemizedlist>
    <listitem>an Intel processor with the Intel VT and the Intel 64 extensions, or</listitem>
    <listitem>an AMD processor with the AMD-V and the AMD64 extensions.</listitem>
  </itemizedlist>

  <para>This document will focus on using virtual machines a primary method
  for testing client installations and updates.</para>

  <para>For capacity planning purposes, the machine should have a separate
  logical or physical drive for the <filename
  class="directory">/var</filename> directory. <application
  class="software">SystemBuilder</application> uses the <filename
  class="directory">/var/cache/systembuilder</filename> folder for caching 
  distribution contents and the <filename 
  class="directory">/var/www/html/distributions</filename> folder for storing
  completed distributions. The recommended minimum drive space allocated for
  each of these folders is 15GB (30GB total). Depending upon the number and size
  of distributions created, you may need more disk space.</para>

  <para>Disk access is another consideration. Due to the size of the files
  handled, fast disk access is preferable. To accommodate the speed
  requirements, it is best to use hard disk drives with Serial Advanced
  Technology Attachment (SATA) interfaces.</para>

  <para>SystemBuilder makes it easy to test client machine installations and
  updates over the network directly from the build machine. To make use of this
  feature, you will need to install and configure a web server.</para>

  <para>First, install and configure the Apache web server by completing the
  following steps as the root user.</para>

  <para><informalexample><programlisting>
# yum install httpd
# service httpd start
# chkconfig --level 3 httpd on</programlisting></informalexample></para>

  <para>Next, modify your firewall configuration, if needed, to allow 
  www/http traffic (port 80) using the command below as the root user.</para>

  <para><programlisting># system-config-securitylevel</programlisting></para>

  <para>To install and configure support for testing distributions using KVM-based virtual
  machines (recommended), complete these additional steps as the root user. Note the OS and system requirements specified earlier in this section.</para>

  <para>First, install the kvm package group.</para>

  <para><informalexample><programlisting>
# yum groupinstall kvm
  </programlisting></informalexample></para>

  <para>Next, using a text editor, modify <filename>/etc/libvirt/qemu/networks/default.xml</filename> to add &lt;forward mode='nat'/&gt; above &lt;bridge name='virbr0'/&gt; as follows:</para>

  <para><informalexample><programlisting>
====
&lt;forward mode='nat'/&gt;
&lt;bridge name='virbr0'/&gt;
=====
  </programlisting></informalexample></para>

  <para>Finally, restart your system.</para>

  <para><informalexample><programlisting>
# shutdown -r now
  </programlisting></informalexample></para>

  <para>Now you are ready to begin defining your distribution!</para>
</section>
