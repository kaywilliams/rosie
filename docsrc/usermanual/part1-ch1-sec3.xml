<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
"http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
<section>
  <title>Spin's Physical Architecture and the Appliance Creation
  Process</title>

  <para><application>Spin</application> has two directory architectures: the
  structure that it creates when you install <application
  class="software">Spin</application> and the default structure <application
  class="software">Spin</application> uses when creating an appliance. The
  latter structure aids in creating, building and deploying your
  appliances.</para>

  <section>
    <title>Spin's installed architecture</title>

    <para>Developed using the <application
    class="software">Python</application> interpreter, the installed
    <application class="software">Spin</application> application has several
    key subdirectories. To install and operate <application
    class="software">Spin</application> you must be a root user. If you
    install it from the RPM packages, its operating files will be in the
    <filename class="directory">/usr</filename> directory. If you choose to
    install from the source, you will need to complete additional
    configuration steps. Refer to Spin's "Installation Guide."</para>

    <para><table>
        <title>Spin Build System Directory Structure</title>

        <tgroup cols="2">
          <tbody>
            <row>
              <entry>/etc/yum.repos.d/spin.repo</entry>

              <entry>Repository base URLs for <application
              class="software">Spin</application> hosted by Rendition
              Software.</entry>
            </row>

            <row>
              <entry>/usr/bin/spin</entry>

              <entry>The <command>spin</command> command.</entry>
            </row>

            <row>
              <entry>/usr/lib/python<varname>$version</varname>/site-packages/spin</entry>

              <entrytbl cols="1">
                <tbody>
                  <row>
                    <entry>Python code for <application
                    class="software">Spin</application>, where
                    <varname>$version</varname> is the <application
                    class="software">Python</application> version.</entry>
                  </row>
                </tbody>
              </entrytbl>
            </row>

            <row>
              <entry>/usr/share/doc/spin-<varname>$version</varname></entry>

              <entry>Documentation for <application
              class="software">Spin</application>, where
              <varname>$version</varname> is the <application
              class="software">Spin</application> version.</entry>
            </row>

            <row>
              <entry>/usr/share/spin/schemas</entry>

              <entry>Relax NG schemas for appliance file validation.</entry>
            </row>
          </tbody>
        </tgroup>
      </table></para>
  </section>

  <section>
    <title>Spin's default appliance structure</title>

    <para>One strength of <application class="software">Spin</application> is
    that with a minimal <filename class="extension">.appliance</filename> file
    you can create a custom appliance with a base OS and architecture and the
    desired applications. To accomplish this, <application
    class="software">Spin</application> relies on several default settings on
    the build system, noted in the table below. The variable
    <varname>$APPLIANCEID</varname> is the appliance's identifier, consisting
    of the appliance's name, version and architecture as specified in the
    <emphasis>main</emphasis> top-level element. The variable
    <varname>$APPLIANCEFILE</varname> is the name of your appliance definition
    file without the <filename class="extension">.appliance</filename>
    extension.</para>

    <para><table>
        <title>Default Folders and Files Spin Generates on the Build System
        and Download Server</title>

        <tgroup cols="2">
          <tbody>
            <row>
              <entry><varname>$APPLIANCEFILE</varname>.dat</entry>

              <entry>Appliance data file. Used by Spin to manage the
              appliance's RPM release numbers. This file should be version
              controlled.</entry>
            </row>

            <row>
              <entry>/var/cache/spin/.cache</entry>

              <entry>Shared download cache.</entry>
            </row>

            <row>
              <entry>/var/cache/spin/<varname>$APPLIANCEID</varname>/</entry>

              <entry>Cache for your appliance's build.</entry>
            </row>

            <row>
              <entry>/var/log/spin.log</entry>

              <entry>Spin's default log file.</entry>
            </row>

            <row>
              <entry>/var/www/html/appliances/<varname>$APPLIANCEID/</varname></entry>

              <entry>Directory to which Spin publishes an appliance.</entry>
            </row>
          </tbody>
        </tgroup>
      </table></para>

    <para>Another strength of <application
    class="software">Spin</application>'s is its use of a cache to increase
    the build speed, noted in the table above. After the initial build, when
    Spin downloads all the necessary packages, subsequent builds take a
    fraction of the time because Spin relies on the cached RPM contents and
    only looks for changes in the appliance.</para>
  </section>
</section>
