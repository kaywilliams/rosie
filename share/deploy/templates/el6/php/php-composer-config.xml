<config-rpm id='php-composer-config'>
<macro id='composer-dir'>/usr/share/composer</macro>
<requires>curl</requires>
<requires>php</requires>
<requires>/usr/sbin/crond</requires>
<script type='post'>
if [ ! -d %{composer-dir} ]; then
  mkdir -p %{composer-dir}
  cd %{composer-dir}
  curl -sS https://getcomposer.org/installer | php >/dev/null || exit 1
fi
</script>
<files destdir="/etc/profile.d" destname='php-composer.sh' content='text'>
# add php composer dir to path 
if ! echo ${PATH} | /bin/grep -q %{composer-dir}/vendor/bin ; then
        export PATH=%{composer-dir}/vendor/bin:${PATH}
fi
</files>
<files content='text' destdir='/etc/cron.daily' destname='php-composer-update' 
       mode='777'>
cd %{composer-dir}
%{composer-dir}/composer.phar update
</files>
</config-rpm>
