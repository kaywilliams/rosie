<?xml version="1.0" encoding="utf-8"?>
<script id='virt-activate' type='activate'>
#!/usr/bin/python
import libvirt
import sys
connection = libvirt.open('qemu:///system')
try: #vm exists?
  vm = connection.lookupByName('%{fqdn}')
except libvirt.libvirtError:
  print "vm does not exist"
  sys.exit(1)
state = vm.state(0)[0]
if state == 1: # vm is active
  sys.exit(0) 
elif state == 3: # vm is paused 
  if vm.resume() == 0: 
    sys.exit(0) #resume succeded
  else:
    print "vm is paused and failed to resume"
    sys.exit(1)
elif vm.create() == 0: # vm is inactive
  sys.exit(0)
else:
  print "vm is inactive and failed to start"
  sys.exit(1)
</script>
